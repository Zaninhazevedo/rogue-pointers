#include <ncurses.h>
#include "game_types.h"
#include "engine_types.h"
#include "../../engine/render/draw.c"

// Função de teste que desenha uma imagem no ecrã
int draw_mario(){
    Pixel pixels[144] = {
        {{3,0}, 8},
        {{4,0}, 8},
        {{5,0}, 8},
        {{6,0}, 8},
        {{7,0}, 8},
        {{2,1}, 8},
        {{3,1}, 8},
        {{4,1}, 8},
        {{5,1}, 8},
        {{6,1}, 8},
        {{7,1}, 8},
        {{8,1}, 8},
        {{9,1}, 8},
        {{10,1}, 8},
        {{2,2}, 10},
        {{3,2}, 10},
        {{4,2}, 10},
        {{5,2}, 11},
        {{6,2}, 11},
        {{7,2}, COLOR_BLACK},
        {{8,2}, 11},
        {{1,3}, 10},
        {{2,3}, 11},
        {{3,3}, 10},
        {{4,3}, 11},
        {{5,3}, 11},
        {{6,3}, 11},
        {{7,3}, COLOR_BLACK},
        {{8,3}, 11},
        {{9,3}, 11},
        {{10,3}, 11},
        {{1,4}, 10},
        {{2,4}, 11},
        {{3,4}, 10},
        {{4,4}, 10},
        {{5,4}, 11},
        {{6,4}, 11},
        {{7,4}, 11},
        {{8,4}, COLOR_BLACK},
        {{9,4}, 11},
        {{10,4}, 11},
        {{11,4}, 11},
        {{1,5}, 10},
        {{2,5}, 10},
        {{3,5}, 11},
        {{4,5}, 11},
        {{5,5}, 11},
        {{6,5}, 11},
        {{7,5}, COLOR_BLACK},
        {{8,5}, COLOR_BLACK},
        {{9,5}, COLOR_BLACK},
        {{10,5}, COLOR_BLACK},
        {{3,6}, 11},
        {{4,6}, 11},
        {{5,6}, 11},
        {{6,6}, 11},
        {{7,6}, 11},
        {{8,6}, 11},
        {{9,6}, 11},
        {{2,7}, 8},
        {{3,7}, 8},
        {{4,7}, 9},
        {{5,7}, 8},
        {{6,7}, 8},
        {{7,7}, 8},
        {{8,7}, 8},
        {{1,8}, 8},
        {{2,8}, 8},
        {{3,8}, 8},
        {{4,8}, 9},
        {{5,8}, 8},
        {{6,8}, 8},
        {{7,8}, 9},
        {{8,8}, 8},
        {{9,8}, 8},
        {{10,8}, 8},
        {{0,9}, 8},
        {{1,9}, 8},
        {{2,9}, 8},
        {{3,9}, 8},
        {{4,9}, 9},
        {{5,9}, 9},
        {{6,9}, 9},
        {{7,9}, 9},
        {{8,9}, 8},
        {{9,9}, 8},
        {{10,9}, 8},
        {{11,9}, 8},
        {{0,10}, 11},
        {{1,10}, 11},
        {{2,10}, 8},
        {{3,10}, 9},
        {{4,10}, 12},
        {{5,10}, 9},
        {{6,10}, 9},
        {{7,10}, 12},
        {{8,10}, 9},
        {{9,10}, 8},
        {{10,10}, 11},
        {{11,10}, 11},
        {{0,11}, 11},
        {{1,11}, 11},
        {{2,11}, 11},
        {{3,11}, 9},
        {{4,11}, 9},
        {{5,11}, 9},
        {{6,11}, 9},
        {{7,11}, 9},
        {{8,11}, 9},
        {{9,11}, 11},
        {{10,11}, 11},
        {{11,11}, 11},
        {{0,12}, 11},
        {{1,12}, 11},
        {{2,12}, 9},
        {{3,12}, 9},
        {{4,12}, 9},
        {{5,12}, 9},
        {{6,12}, 9},
        {{7,12}, 9},
        {{8,12}, 9},
        {{9,12}, 9},
        {{10,12}, 11},
        {{11,12}, 11},
        {{2,13}, 9},
        {{3,13}, 9},
        {{4,13}, 9},
        {{7,13}, 9},
        {{8,13}, 9},
        {{9,13}, 9},
        {{1,14}, 10},
        {{2,14}, 10},
        {{3,14}, 10},
        {{8,14}, 10},
        {{9,14}, 10},
        {{10,14}, 10},
        {{0,15}, 10},
        {{1,15}, 10},
        {{2,15}, 10},
        {{3,15}, 10},
        {{8,15}, 10},
        {{9,15}, 10},
        {{10,15}, 10},
        {{11,15}, 10},
    };

    Image mario = create_image(144, pixels);

    Vector2D pos = {0,0};

    draw_to_screen(mario, pos);

    int key = 0;
    while(1){
        key = getch();
        switch (key)
        {
            case 65:
                pos.y--;
                break;
            case 66:
                pos.y++;
                break;
            case 67:
                pos.x++;
                break;
            case 68:
                pos.x--;
                break;
            default:
                break;
        }
        clear();
        draw_to_screen(mario, pos);
        mvprintw(0,0, "(%d, %d)", pos.x, pos.y);
    }

    return 0;
}

int pixel_test(){
    draw_mario();
    return 0;
}
